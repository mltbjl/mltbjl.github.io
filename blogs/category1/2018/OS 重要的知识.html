<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OS 重要的知识 | 麻辣烫不加辣</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="头标.png">
    <meta name="description" content="""his is myblog">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.0ab6a768.css" as="style"><link rel="preload" href="/assets/js/app.faa17523.js" as="script"><link rel="preload" href="/assets/js/3.d40710ef.js" as="script"><link rel="preload" href="/assets/js/1.7e378398.js" as="script"><link rel="preload" href="/assets/js/25.8c61ea18.js" as="script"><link rel="prefetch" href="/assets/js/10.66a2476e.js"><link rel="prefetch" href="/assets/js/11.fb7d12d0.js"><link rel="prefetch" href="/assets/js/12.a9e9c0c2.js"><link rel="prefetch" href="/assets/js/13.6a93ecf1.js"><link rel="prefetch" href="/assets/js/14.be681b15.js"><link rel="prefetch" href="/assets/js/15.c3f94c5e.js"><link rel="prefetch" href="/assets/js/16.553281df.js"><link rel="prefetch" href="/assets/js/17.dfe6141d.js"><link rel="prefetch" href="/assets/js/18.1751d85f.js"><link rel="prefetch" href="/assets/js/19.f2e0e249.js"><link rel="prefetch" href="/assets/js/20.e940d874.js"><link rel="prefetch" href="/assets/js/21.5f7d4709.js"><link rel="prefetch" href="/assets/js/22.bb3d4add.js"><link rel="prefetch" href="/assets/js/23.f36bc449.js"><link rel="prefetch" href="/assets/js/24.5020b4da.js"><link rel="prefetch" href="/assets/js/26.95fcf31d.js"><link rel="prefetch" href="/assets/js/27.b3500f6e.js"><link rel="prefetch" href="/assets/js/28.bd6e122c.js"><link rel="prefetch" href="/assets/js/29.6196297d.js"><link rel="prefetch" href="/assets/js/30.e10cee0b.js"><link rel="prefetch" href="/assets/js/31.8e89e0e4.js"><link rel="prefetch" href="/assets/js/32.4fffa058.js"><link rel="prefetch" href="/assets/js/33.bfd6421c.js"><link rel="prefetch" href="/assets/js/34.dd051c60.js"><link rel="prefetch" href="/assets/js/35.22b02e0e.js"><link rel="prefetch" href="/assets/js/36.6d34fd45.js"><link rel="prefetch" href="/assets/js/37.51aa0fff.js"><link rel="prefetch" href="/assets/js/38.dcd289ce.js"><link rel="prefetch" href="/assets/js/39.70de9eaf.js"><link rel="prefetch" href="/assets/js/4.51cbaa00.js"><link rel="prefetch" href="/assets/js/40.88d489fb.js"><link rel="prefetch" href="/assets/js/41.bcbda0f8.js"><link rel="prefetch" href="/assets/js/42.54f797c2.js"><link rel="prefetch" href="/assets/js/43.3f32ba16.js"><link rel="prefetch" href="/assets/js/44.251dd9e6.js"><link rel="prefetch" href="/assets/js/45.611cf99a.js"><link rel="prefetch" href="/assets/js/46.38fcf7e1.js"><link rel="prefetch" href="/assets/js/47.d3ba7f51.js"><link rel="prefetch" href="/assets/js/48.8c9e1a9f.js"><link rel="prefetch" href="/assets/js/49.02338805.js"><link rel="prefetch" href="/assets/js/5.78f022ed.js"><link rel="prefetch" href="/assets/js/50.192722b5.js"><link rel="prefetch" href="/assets/js/51.21bdb02f.js"><link rel="prefetch" href="/assets/js/52.48b4c347.js"><link rel="prefetch" href="/assets/js/53.993caab3.js"><link rel="prefetch" href="/assets/js/54.997ced4c.js"><link rel="prefetch" href="/assets/js/55.5ede185b.js"><link rel="prefetch" href="/assets/js/56.9636df42.js"><link rel="prefetch" href="/assets/js/57.3a9aeb00.js"><link rel="prefetch" href="/assets/js/58.31744a2f.js"><link rel="prefetch" href="/assets/js/59.d1b7fda5.js"><link rel="prefetch" href="/assets/js/6.1dbfeed7.js"><link rel="prefetch" href="/assets/js/60.a4895531.js"><link rel="prefetch" href="/assets/js/61.c02db56a.js"><link rel="prefetch" href="/assets/js/62.2e71a0a3.js"><link rel="prefetch" href="/assets/js/63.90234e4b.js"><link rel="prefetch" href="/assets/js/64.9181ec64.js"><link rel="prefetch" href="/assets/js/65.4ff48956.js"><link rel="prefetch" href="/assets/js/66.1d61bfe7.js"><link rel="prefetch" href="/assets/js/67.8708fa10.js"><link rel="prefetch" href="/assets/js/68.259b39a4.js"><link rel="prefetch" href="/assets/js/69.5ec8555c.js"><link rel="prefetch" href="/assets/js/7.613fbb1a.js"><link rel="prefetch" href="/assets/js/70.e1613f74.js"><link rel="prefetch" href="/assets/js/71.2c17a996.js"><link rel="prefetch" href="/assets/js/8.8cfbbdc8.js"><link rel="prefetch" href="/assets/js/9.35d202ea.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0ab6a768.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-5bb33761><div data-v-5bb33761><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-5bb33761 data-v-5bb33761><h3 class="title" data-v-59e6cb88>麻辣烫不加辣</h3> <p class="description" data-v-59e6cb88>&quot;&quot;his is myblog</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>考小拉</span>
          
        <span data-v-59e6cb88>2017 - </span>
        2024
      </a></span></div></div> <div class="hide" data-v-5bb33761><header class="navbar" data-v-5bb33761><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/1e64b7cc830c848fe6800ffc14ab1d2.jpg" alt="麻辣烫不加辣" class="logo"> <span class="site-name">麻辣烫不加辣</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      目录
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/学习小记/" class="nav-link"><i class="undefined"></i>
  学习小记
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      文件
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/theme-reco/" class="nav-link"><i class="undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/recoluan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-5bb33761></div> <aside class="sidebar" data-v-5bb33761><div class="personal-info-wrapper" data-v-1fad0c41 data-v-5bb33761><img src="/398f8e744c4ae5e78367ae601358966f_1.jpg" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    考小拉
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>57</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>33</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      目录
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/学习小记/" class="nav-link"><i class="undefined"></i>
  学习小记
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      文件
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/theme-reco/" class="nav-link"><i class="undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/recoluan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-5bb33761><h3 class="title" data-v-59e6cb88>OS 重要的知识</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>考小拉</span>
          
        <span data-v-59e6cb88>2017 - </span>
        2024
      </a></span></div></div> <div data-v-5bb33761><div data-v-5bb33761><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">OS 重要的知识</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>考小拉</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>9/23/2023</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>秋招</span><span class="tag-item" data-v-8a445198>OS</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="虚拟内存"><a href="#虚拟内存" class="header-anchor">#</a> 虚拟内存</h2> <p>我们的 <code>CPU</code> 是可以直接操作物理内存的，但是这样很危险啊，这就会造就内存中不可能同时运行两个程序；</p> <p>总的来说：<strong>操作系统引入了虚拟内存，进程持有的虚拟内存会通过 <code>CPU</code> 芯片中的内存管理单元（<code>MMU</code>）的映射关系来进行转换成物理地址，然后再通过物理地址来访问内存。</strong></p> <p><a href="https://cdn.xiaolincoding.com//mysql/other/72ab76ba697e470b8ceb14d5fc5688d9.png" target="_blank" rel="noopener noreferrer">图片展示<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://cdn.xiaolincoding.com//mysql/other/72ab76ba697e470b8ceb14d5fc5688d9.png" alt="img"></p> <p>那问题来了，操作系统是如何管理虚拟内存和物理内存之间的关系的？内存分页、内存分段、段页式管理</p> <h3 id="os如何管理虚拟内存和物理内存之间的关系"><a href="#os如何管理虚拟内存和物理内存之间的关系" class="header-anchor">#</a> OS如何管理虚拟内存和物理内存之间的关系</h3> <ul><li><p><a href="https://cdn.xiaolincoding.com//mysql/other/c5e2ab63e6ee4c8db575f3c7c9c85962.png" target="_blank" rel="noopener noreferrer">内存分段<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://cdn.xiaolincoding.com//mysql/other/c5e2ab63e6ee4c8db575f3c7c9c85962.png" alt="img"></p> <p>可以记住我们内存分段的结构，是通过 【段基地址】和【段界限】来进行映射到我们的物理地址的；当 <code>CPU</code> 通过段号找到我们的段基地址后，然后在加上段界限来找到我们的物理地址；</p> <p>但是有缺点：</p> <ol><li><p>图中我们都可以看到，有可能<strong>导致内存碎片问题</strong>；因为每个段的长度不固定，所以多个段未必能恰好能使用所有的内存空间，从而导致多个不连续的小物理内存，导致新的程序无法被加载（原本多个不连续的物理内存是可以加载的）；</p></li> <li><p>第二个就是<strong>有可能导致内存交换的效率低</strong>的问题；我们知道，解决外部内存碎片问题是使用<strong>内存交换</strong>；可以把第一个程序占用的内存写回到硬盘，然后再从硬盘中读取到内存；但是此时内存中原本属于第一个程序的内存被占用了，那么就紧跟着第二个硬盘的空间上进行加载即可。</p> <p>这个内存交换空间，在 <code>Linux</code> 系统里，也就是我们常看到的 <code>Swap</code> 空间，这块空间是从硬盘划分出来的，用于内存与硬盘的空间交换。</p> <p>但是这样恰恰带来了问题，因为磁盘的访问速度比这个内存慢多了，所以每一次的内存交换，都需要把一大段连续的内存数据写到磁盘中；<strong>如果内存交换的时候，交换的是一个占内存空间很大的程序，这样整个机器都会显得卡顿。</strong></p></li></ol></li> <li><p><a href="https://cdn.xiaolincoding.com//mysql/other/7884f4d8db4949f7a5bb4bbd0f452609.png" target="_blank" rel="noopener noreferrer">内存分页<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>分页就是把整个虚拟和物理内存空间切成一段段固定尺寸大小</strong>；这样一个连续并且尺寸固定的内存空间，我们叫<strong>页</strong>；在 <code>Linux</code> 下，我们的页固定大小为 4 KB。</p> <p>当进程访问的虚拟地址在页表中查不到时，系统会产生一个<strong>缺页异常</strong>，进入系统内核空间分配物理内存、更新进程页表，最后再返回用户空间，恢复进程的运行；</p> <p>分页如何解决内存交换效率低的问题？</p> <p>如果磁盘内存空间不足；OS 会将其他正在运行的进程中的【最近没被使用】的内存页面给释放掉，也就是暂时写在磁盘上，等到需要的时候在进行加载到我们的内存中；所以一次性写入磁盘的也只有少数的一个页或者几个页，内存交换效率就高了；</p> <p><img src="https://cdn.xiaolincoding.com//mysql/other/388a29f45fe947e5a49240e4eff13538-20230309234651917.png" alt="img"></p> <p>更进一步，我们不需要一次性把<strong>程序加载到物理内存</strong>中；<strong>我们完全可以只有在程序运行时，需要用到对应虚拟内存页里面的指令和数据时，再加载到物理内存里面去。</strong></p> <p>分页机制下，虚拟地址和物理地址如何映射？</p> <p><a href="https://cdn.xiaolincoding.com//mysql/other/7884f4d8db4949f7a5bb4bbd0f452609.png" target="_blank" rel="noopener noreferrer">图片展示<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://cdn.xiaolincoding.com//mysql/other/7884f4d8db4949f7a5bb4bbd0f452609.png" alt="img"></p> <p>结构有 <strong>页号</strong>和<strong>页内偏移</strong>；<strong>页号代表页表的索引</strong>，页表包含<strong>物理页每页所在物理内存的基地址（也就是物理页号）</strong>，这个<strong>基地址和页内偏移的组合形成了物理内存地址</strong>；</p> <p>步骤：虚拟内存被切分为页号和页内偏移量；然后根据页号找到了页表的对应的物理页号；然后直接拿物理页号加上页内偏移量，就得到了物理内存地址。</p></li> <li><p><a href="https://cdn.xiaolincoding.com//mysql/other/a3cdf27646b24614a64cfc5d7ccffa35.png" target="_blank" rel="noopener noreferrer"><code>TLB</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（<code>Translation Lookasde Buffer</code>）</p> <p>也叫做页表缓存，快表等</p> <p><img src="https://cdn.xiaolincoding.com//mysql/other/a3cdf27646b24614a64cfc5d7ccffa35.png" alt="img"></p> <p>在 <code>CPU</code> 芯片里面，封装了 <code>MMU</code> 芯片，它用来完成地址转换和 <code>TLB</code> 的访问与交互；有了 <code>TLB</code>，在 <code>CPU</code> 寻址时，会查 <code>TLB</code>，如果没找到才会继续查常规的页表。</p></li> <li><p><a href="https://cdn.xiaolincoding.com//mysql/other/8904fb89ae0c49c4b0f2f7b5a0a7b099.png" target="_blank" rel="noopener noreferrer">段页内存管理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://cdn.xiaolincoding.com//mysql/other/8904fb89ae0c49c4b0f2f7b5a0a7b099.png" alt="img"></p> <p>段页式地址变换中要得到物理地址需要三次内存访问：</p> <ol><li>第一次访问段表，得到<strong>页表起始地址</strong>；</li> <li>第二次访问页表，得到<strong>物理页号</strong>；</li> <li>第三次<strong>将物理页号和页内偏移量组合</strong> ，得到物理地址。</li></ol></li> <li><p>虚拟内存的作用</p> <ol><li>使得一个计算机可以同时运行多个程序嘛，保证了多进程不冲突；如何保证的就是上面虚拟内存和物理内存如何映射可以看出；</li> <li>使得进程运行内存超过物理内存的大小；因为程序运行符合局部性原理，CPU 访问内存会有明显的重复访问的倾向，对于没有经常被访问到的内存，我们可以把它换出物理内存之外，比如磁盘上的 <code>Swap</code> 区域</li></ol></li></ul> <h2 id="进程管理"><a href="#进程管理" class="header-anchor">#</a> 进程管理</h2> <p>进程管理一个很重要的知识点，就是上下文切换，然后我们还需要理解一个知识，就是系统调用，然后了解一下线程调度算法是啥？</p> <ul><li><p>什么是系统调用</p> <p>把进程在系统上的运行分为两个级别，我们首先要了解用户态和内核态这两个玩意；进程在系统上的运行分为两个级别；</p> <p><strong>用户态</strong>运行的进程可以直接读取用户程序的数据，拥有较低的权限；比如读写磁盘，网络通信这些都需要，都<strong>需要向 <code>OS</code> 发起系统调用请求，进入内核态</strong>；</p> <p><strong>内核态</strong>运行的进程可以访问计算机任何的资源；当 <code>OS</code> 接收到进程的系统调用请求时，就会从用户态切换到内核态，执行相应的系统调用，并将结果返回给进程，最后再从内核态切换到用户态。</p></li> <li><p>系统调用会涉及到上下文切换</p> <p>那什么是上下文切换？一个任务切换到另一个任务的运行，成为上下文切换，其中任务可以分为【进程】【线程】【中断】；</p> <p>那好，我们先来看看 <code>CPU</code> 上下文切换：</p> <p>我们的进程都是运行在 <code>CPU</code> 上的，那么在每个任务执行前，<code>CPU</code> 需要知道任务从哪里加载，又从哪里开始运行；所以 <code>OS</code> 需要<strong>事先帮 <code>CPU</code> 设置好 <code>CPU</code> 的寄存器和程序计数器</strong>；（<strong><code>CPU</code> 寄存器</strong>相当于你的口袋，内存相当于你的书包，磁盘相当于你的 柜子；<strong>程序计数器</strong>相当于用来存储 <code>CPU</code> 正在执行的指令位置，或者即将执行的下一条指令位置）</p> <p>所以 <strong><code>CPU</code> 上下文切换</strong>就是先把<strong>上一个任务的 <code>CPU</code> 上下文（<code>CPU</code> 寄存器和程序计数器）保存起来，然后加载新任务的上下文保存到当前的寄存器和程序计数器，最后跳转到程序计数器指定的位置继续运行即可</strong>；</p> <p>我们的 <code>CPU</code> 的上下文是程序计数器和寄存器，那<strong>我们的进程的上下文是啥</strong>？<strong>就是虚拟内存、栈、全局变量等用户空间资源，还包括了内核堆栈、寄存器等内核空间的资源。</strong></p> <p><strong>线程的上下文就是自己的私有数据以及寄存器等不共享的数据即可；</strong></p> <p>补充：进程上下文切换的使用场景：① <code>CPU</code> 分配的时间片用完了；②进程通过 <code>sleep</code> 函数将自己主动挂起；③有更高级别的进程执行，就退位；⑥系统的内存空间不足，也会挂起；</p></li> <li><p>进程间通信有哪些？</p> <p>进程间的通信是一个<strong>递进</strong>的一个过程：</p> <ul><li><p>匿名管道</p> <p>存在于父子进程，子进程会复制父进程的文件描述符，也<strong>只能在父子进程之间进程通信</strong>；</p></li> <li><p>命名管道</p> <p>可以在<strong>毫无关系的两个管道上进行通信</strong>，<strong>提前创建</strong>了一个类型为<strong>管道的设备文件</strong>，在进程里只要使用这个设备文件就可以互相通信；</p> <p>但是缺点是不支持定位读取消息，不适合频繁读取数据的操作；</p></li> <li><p>消息队列</p> <p>存储在内核的消息链表，生命周期不随进程有关；但是有两个缺点：数据大小有限制，不适合大数据的传输；存在用户态和内核态的拷贝，即系统调用嘛</p></li> <li><p>共享内存</p> <p>拿出一块虚拟内存作为共享内存空间，但是又带来了数据冲突的问题</p></li> <li><p>信号量</p> <p>不是一种通信方式，而是一种保证进程之间同步互斥以及数据安全的方式；用于实现进程间的互斥与同步，而不是用于缓存进程间通信的数据；</p></li> <li><p>信号</p> <p>对于<strong>异常情况下</strong>的工作模式，需要用【信号】的方式通知进程，信号是进程间通信机制中<strong>唯一的异步通信机制；</strong></p></li> <li><p><code>Socket</code></p> <p>跨越网络和不同主机实现通信，需要用到 <code>Socket</code> 。</p></li></ul></li></ul> <h2 id="调度算法"><a href="#调度算法" class="header-anchor">#</a> 调度算法</h2> <p>了解一下先来先服务算法、短作业优先算法、多级反馈队列调度算法</p> <ul><li><p><a href="https://cdn.xiaolincoding.com/gh/xiaolincoder/ImageHost/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B/28-%E5%A4%9A%E7%BA%A7%E9%98%9F%E5%88%97.jpg" target="_blank" rel="noopener noreferrer">多级反馈队列调度算法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://cdn.xiaolincoding.com/gh/xiaolincoder/ImageHost/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B/28-%E5%A4%9A%E7%BA%A7%E9%98%9F%E5%88%97.jpg" alt="多级反馈队列"></p> <p>如何工作？</p> <ol><li>设置了多个队列，每个队列不同的优先级，每个<strong>队列优先级从高到低</strong>，同时<strong>优先级越高时间片越短</strong>；</li> <li><strong>新的继承会被放在第一级队列的末尾</strong>，按<strong>先来先服务的原则排队</strong>等待被调度，如果在第一梯队列规定的时间片内没完成，则将其转入第二梯队队列的末尾，以此类推。。</li> <li>当较高优先级的队列为空，才调度较低优先级的队列中的进程运行；<strong>当较高优先级的队列有任务了，就立即停止当前的任务并将任务转移到原队列的末尾，转而去执行较高优先级的进程。</strong></li></ol></li></ul> <h2 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h2> <ul><li><p>线程和进程和协程的区别</p> <ol><li><strong>最大的区别</strong>：进程是 <code>OS</code> 资源分配的最小单位，线程是 <code>CPU</code> 调度的基本单位；</li> <li>进程拥有完整的资源，而线程只含有必不可少的资源，比如寄存器和栈</li> <li>线程创建和销毁的时间和空间开销都小于进程；
<ul><li>进程创建和线程创建不一样，线程只需要创建自己独有的，贡献堆啊，全局变量啊等资源；</li> <li>进程的通信方式都比较复杂；线程通过共享内存和文件资源等进程的东西；</li> <li>线程的上下文切换开销也比进程的小多了。</li></ul></li></ol> <p>协程：是一种<strong>轻量级的线程</strong>，也被称为<strong>用户级线程</strong>；</p> <p>应用场景：协程在异步编程中广泛应用：例如使用协程可以实现高效网络通信，数据库访问等；</p> <p>任务调度：协程可以应用任务调度，例如在<strong>事件驱动的系统中</strong>，<strong>协程可以处理事件并进行任务切换</strong>；</p> <p>大数据处理：在<strong>数据流处理</strong>中，可以<strong>实现数据的流水线处理</strong>；</p> <p>协程的实现方式：<code>Java</code> 的 <code>Coroutine</code> 库等；</p></li> <li><p><a href="https://oss.javaguide.cn/github/javaguide/cs-basics/operating-system/state-transition-of-process.png" target="_blank" rel="noopener noreferrer">线程和进程的状态<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-ac050c62><li class="level-2" data-v-ac050c62><a href="/blogs/category1/2018/OS%20%E9%87%8D%E8%A6%81%E7%9A%84%E7%9F%A5%E8%AF%86.html#虚拟内存" class="sidebar-link reco-side-虚拟内存" data-v-ac050c62>虚拟内存</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/category1/2018/OS%20%E9%87%8D%E8%A6%81%E7%9A%84%E7%9F%A5%E8%AF%86.html#os如何管理虚拟内存和物理内存之间的关系" class="sidebar-link reco-side-os如何管理虚拟内存和物理内存之间的关系" data-v-ac050c62>OS如何管理虚拟内存和物理内存之间的关系</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/category1/2018/OS%20%E9%87%8D%E8%A6%81%E7%9A%84%E7%9F%A5%E8%AF%86.html#进程管理" class="sidebar-link reco-side-进程管理" data-v-ac050c62>进程管理</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/category1/2018/OS%20%E9%87%8D%E8%A6%81%E7%9A%84%E7%9F%A5%E8%AF%86.html#调度算法" class="sidebar-link reco-side-调度算法" data-v-ac050c62>调度算法</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/category1/2018/OS%20%E9%87%8D%E8%A6%81%E7%9A%84%E7%9F%A5%E8%AF%86.html#其他" class="sidebar-link reco-side-其他" data-v-ac050c62>其他</a></li></ul></main></div> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.faa17523.js" defer></script><script src="/assets/js/3.d40710ef.js" defer></script><script src="/assets/js/1.7e378398.js" defer></script><script src="/assets/js/25.8c61ea18.js" defer></script>
  </body>
</html>
